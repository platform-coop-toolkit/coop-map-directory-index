{% extends 'maps/base.html' %}
{% load static %}
{% load i18n %}
{% load maps_extras %}
{% block title %}{{ user.first_name|add:' '|add:user.last_name|titlify }}{% endblock %}
{% block bodyclass %}profile profile--individual{% endblock %}
{% block content %}
    <div class="page-header">
        <p><a class="link--breadcrumb" href="{% url 'index' %}">{% trans "Home" %}</a></p>
        <h1>{{ user.first_name }} {{ user.last_name }}</h1>
        <div class="profile__meta">
            <span class="screen-reader-text">{% trans 'location:' %} </span>
            <svg class="icon icon--location" aria-hidden="true" viewBox="0 0 20 20" focusable="false">
                <use href="{% static 'maps/dist/images/location.svg#location' %}"/>
            </svg>
            {% if user.city or user.state or user.country %}
                {% if user.city %}{{ user.city }}, {% endif %}
                {% if user.state %}{{ user.state }}, {% endif %}
                {% if user.country %}{{ user.country.name }}{% endif %}
            {% endif %}
        </div>
        <div class="profile__meta">
            <span class="screen-reader-text">{% trans 'languages:' %} </span>
            <svg class="icon icon--language-small" aria-hidden="true" viewBox="0 0 20 20" focusable="false">
                <use href="{% static 'maps/dist/images/language-small.svg#language-small' %}"/>
            </svg>
            {% if user.languages.count > 0 %}
                {% for l in user.languages.all %}
                {{ l.iso_name }}
                {% endfor %}
            {% endif %}
        </div>
    </div>

    <div class="tabs">
        <div role="tablist" aria-labelledby="tabs-label">
            <span class="screen-reader-text" id="tabs-label">{% trans 'tab group' %}</span>
            <a class="tab" href="#overview" id="overview-btn" role="tab" aria-controls="overview" aria-selected="true">{% trans 'Overview' %}</a>
            {% if user.related_organizations.count > 0 %}
            <a class="tab" href="#coops" id="coops-btn" role="tab" aria-controls="coops" aria-selected="false">{% trans 'Co-ops' %}</a>
            <a class="tab" href="#clients" id="clients-btn" role="tab" aria-controls="clients" aria-selected="false">{% trans 'Clients' %}</a>
            {% endif %}
        </div>
        <div id="overview" role="tabpanel" aria-labelledby="overview-btn">
            <div class="panel__sidebar">
                <h2>{% trans 'At a glance' %}</h2>
                {% if user.roles.count > 0 %}
                <h3 class="h4">{% trans 'Roles' %}</h3>
                <div class="profile__meta">
                {% for r in user.roles.all %}
                    <svg class="icon icon--{{ r.icon }}" aria-hidden="true" viewBox="0 0 20 20" focusable="false">
                        <use href="{% static 'maps/dist/images/'|add:r.icon|add:'.svg#'|add:r.icon %}"/>
                    </svg> {{ r.name }}{% if not forloop.last %}<br />{% endif %}
                {% endfor %}
                </div>
                {% endif %}
                {% if user.services.count > 0 %}
                <h3 class="h4">{% trans 'Services provided' %}</h3>
                <div class="profile__meta">
                {% for s in user.services.all %}
                {{ s.name }}{% if not forloop.last %}<br />{% endif %}
                {% endfor %}
                </div>
                {% endif %}
                {# Research affiliation #}
                {# Field of research #}
                {# Community building skills #}
                {% if user.usersocialnetwork_set.all.count > 0 %}
                <h2>{% trans 'Social media' %}</h2>
                <ul>
                {% for sn in user.usersocialnetwork_set.all %}
                    {% if sn.socialnetwork.format == 'handle' %}
                        <li class="no-bullet"><svg class="icon icon--{{ sn.socialnetwork.icon }}" aria-hidden="true" viewBox="0 0 20 20" focusable="false">
                        <use href="{% static 'maps/dist/images/'|add:sn.socialnetwork.icon|add:'.svg#'|add:sn.socialnetwork.icon %}"/>
                    </svg><span class="screen-reader-text">{{ sn.socialnetwork.name }}</span> <a rel="external" href="{{ sn.socialnetwork.base_url }}{{ sn.identifier|cut:'@' }}">{{ sn.identifier }}</a></li>
                    {% else %} {# sn.socialnetwork.format == 'url' #}
                        <li class="no-bullet"><svg class="icon icon--{{ sn.socialnetwork.icon }}" aria-hidden="true" viewBox="0 0 20 20" focusable="false">
                        <use href="{% static 'maps/dist/images/'|add:sn.socialnetwork.icon|add:'.svg#'|add:sn.socialnetwork.icon %}"/>
                    </svg><span class="screen-reader-text">{{ sn.socialnetwork.name }}</span> <a rel="external" href="{{ sn.identifier }}">{{ sn.identifier }}</a></li>
                    {% endif %}
                {% endfor %}
                </ul>
                {% endif %}

            </div>
            <div class="panel__content">
                <h2>{% trans 'Bio' %}</h2>
                {% if user.bio %}
                <p>{{ user.bio }}</p>
                {% else %}
                <p>{% trans 'No bio provided.' %}</p>
                {% endif %}
                {% if user.related_organizations.count > 0 %}
                <h2>{% trans 'Co-ops' %}</h2>
                <h2>{% trans 'Clients' %}</h2>
                {% endif %}
                {% if user.projects %}
                <h2>{% trans 'Projects' %}</h2>
                {% endif %}
                <p>
                    <small>
                        {% trans 'Last updated:' %} {{ user.updated_at }}<br />
                        {% trans 'Date joined:' %} {{ user.date_joined }}
                    </small>
                </p>
            </div>
        </div>
        <div id="coops" role="tabpanel" aria-labelledby="coops-btn">
        </div>
        <div id="clients" role="tabpanel" aria-labelledby="clients-btn">
        </div>
    </div>
{% endblock %}
